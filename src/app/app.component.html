<mat-toolbar color="primary">
  <span>RunLite</span>
</mat-toolbar>

<div style="margin-top: 50px">
  <mat-card style="width: 700px; margin: 0 auto">
  <mat-horizontal-stepper linear="false" #stepper >
  <mat-step [stepControl]="searchForm">
    <form [formGroup]="searchForm">
      <ng-template matStepLabel>Encuentra tu viaje</ng-template>
      
      <!-- Destino -->
      <div class="form-row">
          <mat-form-field>
              <mat-label>Destino</mat-label>
              <mat-select formControlName="destino">
                <mat-option *ngFor="let destino of destinations" [value]="destino.id" (click)="destinationSelected(destino.id)">
                  {{ destino.name }}
                </mat-option>
              </mat-select>
            </mat-form-field>

          <mat-checkbox #viajeRedondo formControlName="viajeRedondo">Viaje redondo</mat-checkbox>      
      </div>

      <!-- Viaje de Salida-->
      <div class="form-row">
          <mat-form-field>
            <input matInput [matDatepickerFilter]="goingDatesFilter" (dateChange)="onDateGoingSelected($event)" formControlName="fechaSalida" [min]="minDate" [matDatepicker]="dp1" placeholder="Fecha de salida">
            <mat-datepicker-toggle matSuffix [for]="dp1"></mat-datepicker-toggle>
            <mat-datepicker #dp1 disabled="false"></mat-datepicker>
          </mat-form-field>

          <mat-form-field>
            <mat-label>Hora de Salida</mat-label>
            <mat-select formControlName="horaSalida">
              <mat-option *ngFor="let hour of goingHoursTravels" [value]="hour.id_departure_hour" (click)="hourGoingSelected(hour.hour)">
                {{ hour.hour }}
              </mat-option>
            </mat-select>
          </mat-form-field>

          <mat-form-field>
            <mat-label>Clase</mat-label>
            <mat-select formControlName="claseSalida">
              <mat-option *ngFor="let class of goingClassesTravels" [value]="class" (click)="classGoingSelected(class)">
                {{ class }}
              </mat-option>
            </mat-select>
          </mat-form-field>

          <!-- Bus de Salida -->
          <div style="text-align: center; margin: 10px">Elije tu asiento</div>
          <div class="bus">
            <div class="fila">
              <div class="silla" *ngFor="let item of [].constructor(24); let i = index" 
              [ngClass]="vacantSeat(i+1) ? 'silla-libre' : 'silla-ocupada'" (click)="selectSeat($event, 'silla-ida-seleccionada')" id="{{i+1}}">
                {{ i + 1}}
              </div>
            </div>
            <div class="fila">
              <div class="silla" *ngFor="let item of [].constructor(26); let i = index" 
                [ngClass]="vacantSeat(i+25) ? 'silla-libre' : 'silla-ocupada'" (click)="selectSeat($event, 'silla-ida-seleccionada')" id="{{i+25}}">
                {{ i + 25}}
              </div>
            </div>
          </div>
      </div>

      <div class="form-row" *ngIf="searchForm.value.viajeRedondo">
        <br>
        <hr>
        <br>
        <mat-form-field >
          <input matInput [matDatepickerFilter]="returnDatesFilter" formControlName="fechaRegreso" [min]="minDate" [matDatepicker]="dp2" placeholder="Fecha de regreso">
          <mat-datepicker-toggle matSuffix [for]="dp2"></mat-datepicker-toggle>
          <mat-datepicker #dp2 disabled="false"></mat-datepicker>
        </mat-form-field>

          <mat-form-field>
            <mat-label>Hora de Regreso</mat-label>
            <mat-select>
              <mat-option *ngFor="let hora of horas" [value]="hora.id">
                {{ hora.hour }}
              </mat-option>
            </mat-select>
          </mat-form-field>

         
          <!-- Bus de regreso -->
          <div style="text-align: center; margin: 10px">Elije tu asiento</div>
          <div class="bus">
            <div class="fila">
              <div class="silla" *ngFor="let item of [].constructor(24); let i = index" 
              [ngClass]="vacantSeat(i+1) ? 'silla-libre' : 'silla-ocupada'" (click)="selectSeat($event, 'silla-regreso-seleccionada')" id="{{i+1}}">
                {{ i + 1}}
              </div>
            </div>
            <div class="fila">
              <div class="silla" *ngFor="let item of [].constructor(24); let i = index" 
                [ngClass]="vacantSeat(i+25) ? 'silla-libre' : 'silla-ocupada'" (click)="selectSeat($event, 'silla-regreso-seleccionada')" id="{{i+25}}">
                {{ i + 25}}
              </div>
            </div>
          </div>
      </div>
      
      <br>
        <div>
          {{ searchForm.value | json }}
        </div>
      
      <div>
        <button mat-button matStepperNext>Next</button>
      </div>
    </form>
  </mat-step>
  
  <mat-step [stepControl]="stripeTest">
      <form novalidate (ngSubmit)="buy()" [formGroup]="stripeTest">
        <ng-template matStepLabel>Pago</ng-template>
        <div class="form-row">
          <mat-form-field>
            <input matInput placeholder="Nombre" formControlName="name" required>
          </mat-form-field>
          <mat-form-field>
            <input matInput placeholder="Email" formControlName="email" required>
          </mat-form-field>
        </div>
        
        <div id="card-element" class="field"></div>
        
        <div>
            <button mat-button type="submit">Pagar</button>
        </div>
        

        <!--
        <div>
          <button mat-button matStepperPrevious>Back</button>
          <button mat-button matStepperNext>Next</button>
        </div>
        -->
      </form>
      
  
     
  </mat-step>
  <mat-step>
    <ng-template matStepLabel>Tu ticket</ng-template>
    You are now done.
    <div>
      <button mat-button matStepperPrevious>Back</button>
      <button mat-button (click)="stepper.reset()">Reset</button>
    </div>
  </mat-step>
  </mat-horizontal-stepper>
  </mat-card>
</div>


